<!doctype html>
<html lang="en">
   <head>
		<title></title>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta http-equiv="content-language" content="en" />
		<link type="text/css" rel="stylesheet" href="css/style.css" />
		<script type="text/javascript" src="js/modernizr-2.0.6/modernizr.min.js"></script>
    </head>
    <body>
		
		<div class="container_16">
			<div id="map_canvas" class="map rounded"></div>
		</div>
		
		<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script> 
		<script type="text/javascript" src="js/jquery-1.7.1/jquery.min.js"></script>
		<script type="text/javascript" src="../ui/jquery.ui.map.js"></script>
		
		<script type="text/javascript">
		 $(function() {
             $('#map_canvas').gmap().bind('init', function() { 
            	$.getJSON( 'json/iosalli.json', function(data) { 
    	    	    $.each( data.markers, function(i, marker) {
    		    	    $('#map_canvas').gmap('addMarker', {
    				     'position': new google.maps.LatLng(marker.latitude, marker.longitude), 
    				     'bounds': true 
    				     
    		    	    }).click(function() {
    				        $('#map_canvas').gmap('openInfoWindow', { 'content': marker.content }, this);
    		    	    });
    	    	    });
            	});
            });
			
			$.get("http://ipinfo.io", function (response) {
			  var location = response.loc.split(",");
			  var lat = location[0];
			  var lon = location[1];
			  
			   $('#map_canvas').gmap('addMarker', {
    				     'position': new google.maps.LatLng(lat,lon), 
    				     'bounds': true 
    				     
    		    }).click(function() {
    				        $('#map_canvas').gmap('openInfoWindow', { 'content': 'Your Current Location' }, this);
    		    	    });
				}, "jsonp");	
    	});
        </script>
	</body>
</html>